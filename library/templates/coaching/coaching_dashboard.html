{% extends "base.html" %}

{% block content %}
<div class="max-w-7xl mx-auto px-2 sm:px-4 lg:px-8 py-4 md:py-8">
    <!-- Dashboard Header -->
    <div class="text-center mb-2 sm:mb-3">
        <h1 class="text-xl sm:text-2xl md:text-3xl font-bold text-gray-800 animate-fade-in">
            <span class="text-gray-800">Dashboard</span>
        </h1>
    </div>

    <!-- Header Section -->
    <div class="mb-4 md:mb-8 bg-gradient-to-r from-blue-50 to-green-50 p-4 sm:p-6 rounded-xl shadow-lg border border-gray-100 text-left">
        <div class="flex flex-col md:flex-row items-center justify-between">
            <!-- Image at top on mobile, right on desktop -->
            <div class="w-24 h-24 sm:w-28 sm:h-28 bg-white rounded-lg shadow-md flex items-center justify-center mb-4 md:mb-0 md:ml-4 overflow-hidden border-4 border-white/20 ring-2 ring-blue-200/50 relative group order-first md:order-last">
                {% if institution.image %}
                <img src="https://drive.google.com/thumbnail?id={{ institution.image.google_drive_id }}&sz=s800" 
                     alt="{{ institution.name }} logo" 
                     class="w-full h-full object-cover">
                {% else %}
                <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="w-full h-full text-gray-400">
                    <path d="M4 16L8.586 11.414C8.961 11.039 9.47 10.828 10 10.828C10.53 10.828 11.039 11.039 11.414 11.414L16 16M14 14L15.586 12.414C15.961 12.039 16.47 11.828 17 11.828C17.53 11.828 18.039 12.039 18.414 12.414L20 14M14 8H14.01M6 20H18C19.1046 20 20 19.1046 20 18V6C20 4.89543 19.1046 4 18 4H6C4.89543 4 4 4.89543 4 6V18C4 19.1046 4.89543 20 6 20Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
                {% endif %}
            </div>

            <!-- Text content -->
            <div class="text-center md:text-left">
                <h1 class="text-xl sm:text-2xl md:text-3xl font-bold text-gray-800 mb-2 sm:mb-3 animate-fade-in">
                    <div class="text-blue-600 block mb-2">
                        <span class="font-medium text-gray-500">Institute's Name:</span> 
                        {{ institution.name }}
                    </div>
                    <div class="text-green-600 block">
                        <span class="font-medium text-gray-500">Owner's Name:</span> 
                        {{ request.user.get_full_name }}
                    </div>
                </h1>
                <p class="text-sm sm:text-base text-gray-600 leading-relaxed flex items-center justify-center md:justify-start">
                    <i class="bi bi-gear-fill text-blue-500 mr-2 animate-spin-slow"></i>
                    <span class="bg-clip-text text-transparent bg-gradient-to-r from-blue-600 to-green-600">
                        Manage your institute operations efficiently
                    </span>
                </p>
            </div>
        </div>
    </div>

    <!-- Navigation Buttons -->
    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-2 sm:gap-4 mb-4 md:mb-8">
        <a href="{% url 'manage_institution_users' institution.uid %}" class="bg-blue-600 hover:bg-blue-700 text-white px-3 sm:px-4 py-2 sm:py-3 rounded-lg sm:rounded-xl transition-all duration-300 text-center flex items-center justify-center space-x-1 sm:space-x-2 shadow-md hover:shadow-lg transform hover:scale-105 active:scale-95 text-xs sm:text-sm">
            <i class="bi bi-people-fill text-sm sm:text-lg"></i>
            <span>Manage Users</span>
        </a>
        <a href="{% url 'edit_institution_profile' institution.uid %}" class="bg-green-600 hover:bg-green-700 text-white px-3 sm:px-4 py-2 sm:py-3 rounded-lg sm:rounded-xl transition-all duration-300 text-center flex items-center justify-center space-x-1 sm:space-x-2 shadow-md hover:shadow-lg transform hover:scale-105 active:scale-95 text-xs sm:text-sm">
            <i class="bi bi-pencil-square text-sm sm:text-lg"></i>
            <span>Edit Profile</span>
        </a>
        <a href="{% url 'manage_institution_coupons' institution.uid %}" class="bg-purple-600 hover:bg-purple-700 text-white px-3 sm:px-4 py-2 sm:py-3 rounded-lg sm:rounded-xl transition-all duration-300 text-center flex items-center justify-center space-x-1 sm:space-x-2 shadow-md hover:shadow-lg transform hover:scale-105 active:scale-95 text-xs sm:text-sm">
            <i class="bi bi-ticket-perforated-fill text-sm sm:text-lg"></i>
            <span>Manage Coupons</span>
        </a>
    </div>

    <!-- Cards Grid -->
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3 sm:gap-4">
        <!-- Institute Details Card -->
        <div class="bg-white rounded-lg sm:rounded-xl shadow-md hover:shadow-lg transition-shadow duration-300 p-3 sm:p-4">
            <div class="flex items-center justify-between mb-2 sm:mb-3">
                <div class="flex items-center space-x-2">
                    <i class="bi bi-building text-orange-500 text-lg sm:text-xl"></i>
                    <h2 class="text-sm sm:text-base md:text-lg font-semibold text-gray-700">Institute Details</h2>
                </div>
                <a href="{% url 'edit_institution_profile' institution.uid %}" class="text-sm sm:text-base text-blue-600 hover:text-blue-700 flex items-center space-x-1">
                    <i class="bi bi-pencil-square"></i>
                    <span>Edit</span>
                </a>
            </div>
            <div class="space-y-1 sm:space-y-2">
                <div class="flex items-center justify-between p-1.5 sm:p-2 md:p-3 bg-gray-50 rounded-md sm:rounded-lg">
                    <span class="text-xs sm:text-sm text-gray-600">Email</span>
                    <span class="font-semibold text-blue-600 text-sm sm:text-base md:text-lg">{{ institution.contact_email }}</span>
                </div>
                <div class="flex items-center justify-between p-1.5 sm:p-2 md:p-3 bg-gray-50 rounded-md sm:rounded-lg">
                    <span class="text-xs sm:text-sm text-gray-600">Phone</span>
                    <span class="font-semibold text-green-600 text-sm sm:text-base md:text-lg">{{ institution.contact_phone }}</span>
                </div>
                <div class="flex items-center justify-between p-1.5 sm:p-2 md:p-3 bg-gray-50 rounded-md sm:rounded-lg">
                    <span class="text-xs sm:text-sm text-gray-600">Address</span>
                    <span class="font-semibold text-purple-600 text-sm sm:text-base md:text-lg">{{ institution.address|slice:":35" }}...</span>
                </div>
                {% if institution.website_url %}
                <div class="flex items-center justify-between p-1.5 sm:p-2 md:p-3 bg-gray-50 rounded-md sm:rounded-lg">
                    <span class="text-xs sm:text-sm text-gray-600">Website</span>
                    <a href="{{ institution.website_url }}" class="font-semibold text-indigo-600 text-sm sm:text-base md:text-lg hover:text-indigo-700" target="_blank">
                        {{ institution.website_url|slice:":35" }}...
                    </a>
                </div>
                {% endif %}
            </div>
        </div>

        <!-- Statistics Card -->
        <div class="bg-white rounded-lg sm:rounded-xl shadow-md hover:shadow-lg transition-shadow duration-300 p-3 sm:p-4">
            <div class="flex items-center space-x-2 mb-2 sm:mb-3">
                <i class="bi bi-bar-chart-line-fill text-green-500 text-lg sm:text-xl"></i>
                <h2 class="text-base sm:text-lg font-semibold text-gray-700">Statistics</h2>
            </div>
            <div class="space-y-2">
                <div class="flex items-center justify-between p-2 sm:p-3 bg-gray-50 rounded-md sm:rounded-lg hover:bg-gray-100 transition-colors duration-200">
                    <span class="text-xs sm:text-sm text-gray-600">Total Classrooms</span>
                    <span class="font-semibold text-blue-600 text-base sm:text-lg">{{ institution.classrooms|length }}</span>
                </div>
                <div class="flex items-center justify-between p-2 sm:p-3 bg-gray-50 rounded-md sm:rounded-lg hover:bg-gray-100 transition-colors duration-200">
                    <span class="text-xs sm:text-sm text-gray-600">Total Capacity</span>
                    <span class="font-semibold text-green-600 text-base sm:text-lg">{{ institution.total_capacity }}</span>
                </div>
                <div class="flex items-center justify-between p-2 sm:p-3 bg-gray-50 rounded-md sm:rounded-lg hover:bg-gray-100 transition-colors duration-200">
                    <span class="text-xs sm:text-sm text-gray-600">Status</span>
                    <span class="font-semibold {% if institution.is_approved %}text-green-600{% else %}text-yellow-600{% endif %} text-base sm:text-lg">
                        {% if institution.is_approved %}Approved{% else %}Pending{% endif %}
                    </span>
                </div>
            </div>
        </div>

        <!-- Coupons Card -->
        <div class="bg-white rounded-lg sm:rounded-xl shadow-md hover:shadow-lg transition-shadow duration-300 p-3 sm:p-4">
            <div class="flex items-center justify-between mb-2 sm:mb-3">
                <div class="flex items-center space-x-2">
                    <i class="bi bi-ticket-perforated-fill text-purple-500 text-lg sm:text-xl"></i>
                    <h2 class="text-sm sm:text-base md:text-lg font-semibold text-gray-700">Coupons</h2>
                </div>
                <a href="{% url 'manage_institution_coupons' institution.uid %}" class="text-sm sm:text-base text-purple-600 hover:text-purple-700 flex items-center space-x-1">
                    <i class="bi bi-plus-circle"></i>
                    <span>Manage</span>
                </a>
            </div>
            <div class="space-y-2">
                <div class="flex items-center justify-between p-2 sm:p-3 bg-gray-50 rounded-md sm:rounded-lg hover:bg-gray-100 transition-colors duration-200">
                    <span class="text-xs sm:text-sm text-gray-600">Active Coupons</span>
                    <span class="font-semibold text-purple-600 text-base sm:text-lg">{{ active_coupons_count }}</span>
                </div>
                <div class="flex items-center justify-between p-2 sm:p-3 bg-gray-50 rounded-md sm:rounded-lg hover:bg-gray-100 transition-colors duration-200">
                    <span class="text-xs sm:text-sm text-gray-600">Total Coupons</span>
                    <span class="font-semibold text-blue-600 text-base sm:text-lg">{{ total_coupons_count }}</span>
                </div>
                <div class="flex items-center justify-between p-2 sm:p-3 bg-gray-50 rounded-md sm:rounded-lg hover:bg-gray-100 transition-colors duration-200">
                    <span class="text-xs sm:text-sm text-gray-600">Expired Coupons</span>
                    <span class="font-semibold text-red-600 text-base sm:text-lg">{{ expired_coupons_count }}</span>
                </div>
            </div>
        </div>

        <!-- Additional Services Card -->
        {% if institution.additional_services %}
        <div class="bg-white rounded-lg sm:rounded-xl shadow-md hover:shadow-lg transition-shadow duration-300 p-3 sm:p-4">
            <div class="flex items-center space-x-2 mb-2 sm:mb-3">
                <i class="bi bi-plus-circle-fill text-purple-500 text-lg sm:text-xl"></i>
                <h2 class="text-base sm:text-lg font-semibold text-gray-700">Additional Services</h2>
            </div>
            <div class="p-2 sm:p-3 bg-gray-50 rounded-md sm:rounded-lg">
                <p class="text-sm text-gray-600">{{ institution.additional_services }}</p>
            </div>
        </div>
        {% endif %}
    </div>
</div>
{% endblock %} 
