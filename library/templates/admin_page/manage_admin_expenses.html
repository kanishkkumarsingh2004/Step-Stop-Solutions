{% extends "base.html" %}
{% load static %}

{% block content %}
<div class="min-h-screen bg-gray-50">
    <div class="max-w-7xl mx-auto px-2 sm:px-4 lg:px-8 py-4 sm:py-6 lg:py-8">
        <!-- Page Header -->
        <div class="text-center mb-4 sm:mb-8">
            <h1 class="text-xl sm:text-3xl md:text-4xl font-bold text-gray-900 mb-2 sm:mb-3">Manage Admin Expenses</h1>
            <p class="text-xs sm:text-base text-gray-600 max-w-2xl mx-auto px-2">
                Comprehensive expense management tools for efficient administration
            </p>
        </div>

        <!-- Messages -->
        {% if messages %}
        <div class="mb-4 sm:mb-6">
            {% for message in messages %}
            <div class="{% if message.tags == 'success' %}bg-green-50 text-green-700{% else %}bg-red-50 text-red-700{% endif %} p-2 sm:p-3 rounded-md mb-2 sm:mb-3 text-sm sm:text-base">
                {{ message }}
            </div>
            {% endfor %}
        </div>
        {% endif %}

        <!-- Expense Management Content -->
        <div class="bg-white rounded-lg shadow-md p-3 sm:p-4 lg:p-6">
            <div class="grid grid-cols-1 gap-4 sm:gap-6 md:grid-cols-2">
                <!-- Add Expense Form -->
                <div class="bg-gray-50 p-3 sm:p-4 rounded-lg">
                    <h2 class="text-lg sm:text-xl font-semibold text-gray-800 mb-3 sm:mb-4">Add New Expense</h2>
                    <form method="post" class="space-y-3 sm:space-y-4">
                        {% csrf_token %}
                        <div class="space-y-2 sm:space-y-3">
                            <div>
                                <label for="expense_name" class="block text-xs sm:text-sm font-medium text-gray-700 mb-1 sm:mb-2">Expense Name</label>
                                <input type="text" id="expense_name" name="expense_name" 
                                       class="w-full px-3 py-1.5 sm:px-4 sm:py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition duration-200 text-sm sm:text-base"
                                       required>
                            </div>
                            <div>
                                <label for="amount" class="block text-xs sm:text-sm font-medium text-gray-700 mb-1 sm:mb-2">Amount</label>
                                <input type="number" id="amount" name="amount" step="0.01"
                                       class="w-full px-3 py-1.5 sm:px-4 sm:py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition duration-200 text-sm sm:text-base"
                                       required>
                            </div>
                            <div>
                                <label for="date" class="block text-xs sm:text-sm font-medium text-gray-700 mb-1 sm:mb-2">Date</label>
                                <input type="date" id="date" name="date"
                                       class="w-full px-3 py-1.5 sm:px-4 sm:py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition duration-200 text-sm sm:text-base"
                                       max="{{ today|date:'Y-m-d' }}"
                                       required>
                            </div>
                            <div>
                                <label for="description" class="block text-xs sm:text-sm font-medium text-gray-700 mb-1 sm:mb-2">Description</label>
                                <textarea id="description" name="description" rows="2" class="w-full px-3 py-1.5 sm:px-4 sm:py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition duration-200 text-sm sm:text-base"></textarea>
                            </div>
                            <button type="submit" 
                                    class="w-full bg-blue-600 hover:bg-blue-700 text-white px-4 py-1.5 sm:px-6 sm:py-2 rounded-lg transition-all duration-300 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 text-sm sm:text-base">
                                Add Expense
                            </button>
                        </div>
                    </form>
                </div>

                <!-- Expense List -->
                <div class="bg-gray-50 p-6 rounded-lg">
                    <div class="flex justify-between items-center mb-6">
                        <h2 class="text-lg sm:text-xl font-semibold text-gray-800">Expense List</h2>
                        <div class="bg-blue-50 px-3 py-1.5 rounded-lg text-center sm:px-4 sm:py-2">
                            <p class="text-xs sm:text-sm font-semibold text-blue-700">
                                Total: ₹{{ total_expenses|floatformat:2 }}
                            </p>
                        </div>
                    </div>
                    <div class="space-y-4">
                        {% for expense in expenses %}
                        <div class="bg-white p-4 rounded-lg shadow-sm hover:shadow-md transition-shadow duration-200">
                            <div class="flex justify-between items-start">
                                <div>
                                    <p class="text-sm font-medium text-gray-800">{{ expense.name }}</p>
                                    <p class="text-xs text-gray-500">{{ expense.date }}</p>
                                </div>
                                <div class="text-right">
                                    <p class="text-sm font-semibold text-red-600">₹{{ expense.amount }}</p>
                                    <p class="text-xs text-gray-500">Added by: {{ expense.created_by.get_full_name|default:"Admin" }}</p>
                                </div>
                            </div>
                            {% if expense.description %}
                            <div class="mt-2 pt-2 border-t border-gray-100">
                                <p class="text-xs text-gray-600">{{ expense.description }}</p>
                            </div>
                            {% endif %}
                        </div>
                        {% empty %}
                        <div class="text-center text-gray-500 py-4">
                            No expenses recorded yet
                        </div>
                        {% endfor %}
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}