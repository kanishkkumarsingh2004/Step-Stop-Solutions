{% extends "base.html" %}
{% load static %}

{% block content %}
<div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <div class="bg-white rounded-lg shadow-xl p-8">
        <div class="mb-8">
            <h1 class="text-3xl font-bold text-gray-800">Payment for {{ gym.venue_name }}</h1>
            <p class="text-gray-600 mt-2">Plan: {{ plan.name }} - ₹{{ final_amount }}</p>
        </div>

        <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
            <!-- QR Code Section -->
            <div class="text-center">
                <h2 class="text-xl font-semibold mb-4">Scan QR Code to Pay</h2>
                {% if qr_code_url %}
                    <img src="{{ qr_code_url }}" alt="UPI QR Code" class="mx-auto border rounded-lg">
                {% else %}
                    <p class="text-gray-500">QR Code not available. Use UPI ID: {{ gym.upi_id }}</p>
                {% endif %}
                <p class="mt-4 text-lg font-medium">Amount: ₹{{ final_amount }}</p>
                <p class="text-sm text-gray-600">UPI ID: {{ gym.upi_id }}</p>
                <p class="text-sm text-gray-600">Recipient: {{ gym.recipient_name }}</p>
            </div>

            <!-- Payment Form -->
            <div>
                <form method="post" action="{% url 'gym_payment_success' gym.id plan.id %}">
                    {% csrf_token %}
                    <input type="hidden" name="coupon_code" value="{{ coupon_code }}">
                    <input type="hidden" name="final_amount" value="{{ final_amount }}">

                    <div class="mb-4">
                        <label for="payment_mode" class="block text-sm font-medium text-gray-700 mb-2">
                            Payment Mode
                        </label>
                        <select id="payment_mode" name="payment_mode" class="w-full border border-gray-300 rounded-md px-4 py-2 focus:ring-2 focus:ring-green-300 focus:border-green-400">
                            <option value="UPI">UPI</option>
                            <option value="CASH">Cash</option>
                        </select>
                    </div>

                    <div class="mb-4">
                        <label for="transaction_id" class="block text-sm font-medium text-gray-700 mb-2">
                            Transaction ID
                        </label>
                        <input type="text" id="transaction_id" name="transaction_id" class="w-full border border-gray-300 rounded-md px-4 py-2 focus:ring-2 focus:ring-green-300 focus:border-green-400" required>
                        <p class="text-sm text-gray-500 mt-1">Enter the transaction ID from your payment app or receipt.</p>
                    </div>

                    <div class="flex justify-end space-x-4 pt-6">
                        <a href="{% url 'gym_subscription' gym.id %}" class="px-6 py-3 bg-gray-300 text-gray-700 rounded-lg hover:bg-gray-400 transition-colors duration-200">
                            Cancel
                        </a>
                        <button type="submit" id="proceed-btn" class="px-6 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors duration-200" disabled>
                            Proceed
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>
<script src="{% static 'gym_js/gym_payment.js' %}"></script>
{% endblock %}
